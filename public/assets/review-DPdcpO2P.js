import{c as B,_ as R}from"./index-DNBbsmjl.js";import{B as W,b as v,a as X,o as Z,I as _,Z as q,C as c,D as i,G as t,H as n,P as l,X as d,_ as J,U as p,$ as f,V as N,W as V,O as M,a1 as h,ai as K}from"./vue-_nkvHh4F.js";const Q={class:"review-status-page"},Y={class:"container"},ee={class:"stats-section"},te={class:"stat-content"},se={class:"stat-number"},ae={class:"stat-content"},oe={class:"stat-number"},ne={class:"stat-content"},le={class:"stat-number"},ie={class:"content-section"},re={class:"card-header"},ce={class:"filter-section"},de={class:"list-section"},_e={key:0,class:"empty-state"},ue={key:1,class:"declaration-list"},pe={class:"item-header"},ve={class:"item-info"},ge={class:"item-title"},me={class:"amount-text"},fe={class:"item-meta"},he={class:"voucher-type"},ye={class:"item-time"},we={class:"item-content"},ke={key:0,class:"images-preview"},xe={key:0,class:"more-images"},be={key:1,class:"remark-section"},Ce={class:"remark-content"},ze={key:2,class:"review-remark-section"},De={class:"remark-content"},Se={key:3,class:"review-time"},Be={class:"item-actions"},Ne={key:2,class:"pagination-section"},Ve=W({__name:"review",setup(Me){const b=v(!1),g=v(1),y=v(20),z=v(0),w=v(""),k=v([]),u=X({pending_count:0,approved_count:0,total:0}),T=r=>{const e=Number(r);return Number.isNaN(e)?"0.00":e.toFixed(2)+" 元"},U=r=>({pending:"warning",approved:"success",rejected:"danger",cancelled:"info"})[r]||"info",D=()=>{window.location.href="/rightsDeclaration"},m=async()=>{var r,e;b.value=!0;try{const o={page:g.value,limit:y.value};w.value&&(o.status=w.value);const a=await B({url:"/api/rightsDeclaration/reviewStatus",method:"get",params:o});a.code===1?(k.value=a.data.list,z.value=a.data.total,u.pending_count=a.data.pending_count,u.approved_count=a.data.approved_count,u.total=a.data.total):h.error(a.msg||"获取数据失败")}catch(o){console.error("获取审核数据失败:",o),h.error((o==null?void 0:o.msg)||((e=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:e.msg)||"获取数据失败")}finally{b.value=!1}},j=async r=>{var e,o;try{await K.confirm("确定要撤销这个申报吗？撤销后无法恢复。","撤销确认",{confirmButtonText:"确定撤销",cancelButtonText:"取消",type:"warning"});const a=await B({url:"/api/rightsDeclaration/cancel",method:"post",data:{id:r}});a.code===1?(h.success("申报已撤销"),m()):h.error(a.msg||"撤销失败")}catch(a){a!=="cancel"&&(console.error("撤销申报失败:",a),h.error((a==null?void 0:a.msg)||((o=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:o.msg)||"撤销失败"))}},E=r=>{y.value=r,g.value=1,m()},P=r=>{g.value=r,m()};return Z(()=>{m()}),(r,e)=>{const o=_("el-card"),a=_("el-col"),A=_("el-row"),C=_("el-button"),x=_("el-option"),F=_("el-select"),I=_("el-empty"),L=_("el-tag"),$=_("el-image"),G=_("el-pagination"),H=q("loading");return i(),c("div",Q,[t("div",Y,[e[13]||(e[13]=t("h1",{class:"page-title"},"确权审核状态",-1)),t("div",ee,[n(A,{gutter:20},{default:l(()=>[n(a,{span:8},{default:l(()=>[n(o,{class:"stat-card"},{default:l(()=>[t("div",te,[t("div",se,d(u.pending_count),1),e[3]||(e[3]=t("div",{class:"stat-label"},"待审核",-1))])]),_:1})]),_:1}),n(a,{span:8},{default:l(()=>[n(o,{class:"stat-card"},{default:l(()=>[t("div",ae,[t("div",oe,d(u.approved_count),1),e[4]||(e[4]=t("div",{class:"stat-label"},"已通过",-1))])]),_:1})]),_:1}),n(a,{span:8},{default:l(()=>[n(o,{class:"stat-card"},{default:l(()=>[t("div",ne,[t("div",le,d(u.total-u.pending_count-u.approved_count),1),e[5]||(e[5]=t("div",{class:"stat-label"},"其他状态",-1))])]),_:1})]),_:1})]),_:1})]),t("div",ie,[n(o,null,{header:l(()=>[t("div",re,[e[7]||(e[7]=t("span",null,"申报记录",-1)),n(C,{type:"primary",onClick:D,size:"small"},{default:l(()=>e[6]||(e[6]=[f(" 提交新申报 ")])),_:1})])]),default:l(()=>[t("div",ce,[n(F,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),placeholder:"筛选状态",onChange:m,clearable:"",style:{width:"150px","margin-right":"10px"}},{default:l(()=>[n(x,{label:"待审核",value:"pending"}),n(x,{label:"已通过",value:"approved"}),n(x,{label:"已拒绝",value:"rejected"}),n(x,{label:"已撤销",value:"cancelled"})]),_:1},8,["modelValue"])]),J((i(),c("div",de,[k.value.length===0?(i(),c("div",_e,[n(I,{description:"暂无申报记录"},{default:l(()=>[n(C,{type:"primary",onClick:D},{default:l(()=>e[8]||(e[8]=[f(" 提交申报 ")])),_:1})]),_:1})])):(i(),c("div",ue,[(i(!0),c(N,null,V(k.value,s=>(i(),c("div",{key:s.id,class:"declaration-item"},[n(o,{class:"item-card",shadow:"hover"},{default:l(()=>[t("div",pe,[t("div",ve,[t("div",ge,[e[9]||(e[9]=f(" 申报金额： ")),t("span",me,d(T(s.amount)),1)]),t("div",fe,[t("span",he,d(s.voucher_type_text),1),n(L,{type:U(s.status),size:"small"},{default:l(()=>[f(d(s.status_text),1)]),_:2},1032,["type"])])]),t("div",ye,d(s.create_time_text),1)]),t("div",we,[s.images_array&&s.images_array.length>0?(i(),c("div",ke,[(i(!0),c(N,null,V(s.images_array.slice(0,3),(S,O)=>(i(),M($,{key:O,src:S,"preview-src-list":s.images_array,"preview-teleported":!0,class:"preview-image",fit:"cover"},null,8,["src","preview-src-list"]))),128)),s.images_array.length>3?(i(),c("div",xe," +"+d(s.images_array.length-3),1)):p("",!0)])):p("",!0),s.remark?(i(),c("div",be,[e[10]||(e[10]=t("div",{class:"remark-label"},"备注：",-1)),t("div",Ce,d(s.remark),1)])):p("",!0),s.review_remark?(i(),c("div",ze,[e[11]||(e[11]=t("div",{class:"remark-label"},"审核备注：",-1)),t("div",De,d(s.review_remark),1)])):p("",!0),s.review_time_text?(i(),c("div",Se," 审核时间："+d(s.review_time_text),1)):p("",!0)]),t("div",Be,[s.status==="pending"?(i(),M(C,{key:0,type:"danger",size:"small",onClick:S=>j(s.id)},{default:l(()=>e[12]||(e[12]=[f(" 撤销申报 ")])),_:2},1032,["onClick"])):p("",!0)])]),_:2},1024)]))),128))])),k.value.length>0?(i(),c("div",Ne,[n(G,{"current-page":g.value,"onUpdate:currentPage":e[1]||(e[1]=s=>g.value=s),"page-size":y.value,"onUpdate:pageSize":e[2]||(e[2]=s=>y.value=s),"page-sizes":[10,20,50],total:z.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:E,onCurrentChange:P},null,8,["current-page","page-size","total"])])):p("",!0)])),[[H,b.value]])]),_:1})])])])}}}),je=R(Ve,[["__scopeId","data-v-79eff346"]]);export{je as default};
