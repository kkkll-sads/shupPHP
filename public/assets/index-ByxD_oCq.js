import{B as I,N as T,a as k,as as D,w as N,I as n,Z as A,C,D as d,O as m,U as u,H as t,u as b,P as c,_ as E,G as f,p as S,X as x,aW as F,at as P}from"./vue-DnSQgQf0.js";import{u as V,P as B,a as G}from"./popupForm-D4UfcvMk.js";import{a5 as R}from"./index-BR6nH71S.js";import{T as H,a as L}from"./index-B5mnDXNW.js";import{b as U}from"./baTable-CpxZN4RR.js";import"./index-Ch43UxRl.js";import"./validate-B0Iw1M_R.js";import"./index-DGD6GkL-.js";const q={class:"default-main ba-table-box"},K={class:"table-header-operate-text"},O={class:"mlr-12"},ee=I({name:"user/moneyLog",__name:"index",setup(j){const _=T().query.user_id??"",r=k({userInfo:{},selectedFieldType:""}),e=new U(new R(V),{column:[{type:"selection",align:"center",operator:!1},{label:"ID",prop:"id",align:"center",operator:"=",operatorPlaceholder:"ID",width:70},{label:"用户ID",prop:"user_id",align:"center",width:70},{label:"用户名",prop:"user.username",align:"center",operator:"LIKE",operatorPlaceholder:"模糊查询"},{label:"用户昵称",prop:"user.nickname",align:"center",operator:"LIKE",operatorPlaceholder:"模糊查询"},{label:"字段类型",prop:"field_type",align:"center",operator:"select",operatorOptions:[{label:"可用金额",value:"money"},{label:"可提现金额",value:"withdrawable_money"},{label:"确权金",value:"service_fee_balance"},{label:"拓展提现",value:"static_income"},{label:"待激活确权金",value:"pending_activation_gold"},{label:"消费金",value:"score"}],render:"tag",custom:{money:"",withdrawable_money:"success",service_fee_balance:"warning",static_income:"info",pending_activation_gold:"danger",score:"primary"},replaceValue:{money:"可用金额",withdrawable_money:"可提现金额",service_fee_balance:"确权金",static_income:"拓展提现",pending_activation_gold:"待激活确权金",score:"消费金"},width:130},{label:"变动金额",prop:"money",align:"center",operator:"RANGE",sortable:"custom",width:120},{label:"变动前",prop:"before",align:"center",operator:"RANGE",sortable:"custom",width:120},{label:"变动后",prop:"after",align:"center",operator:"RANGE",sortable:"custom",width:120},{label:"备注",prop:"memo",align:"center",operator:"LIKE",operatorPlaceholder:"模糊查询",showOverflowTooltip:!0},{label:"创建时间",prop:"create_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160}],dblClickNotEditColumn:["all"]},{defaultItems:{user_id:_,memo:""}});e.after.onSubmit=()=>{p(e.comSearch.form.user_id)},e.before.onTableAction=({event:a})=>{if(a==="com-search"){e.table.filter.search=e.getComSearchData();for(const l in e.table.filter.search)if(["money","before","after"].includes(e.table.filter.search[l].field)){const s=e.table.filter.search[l].val.split(","),i=[];for(const o in s)i.push(isNaN(parseFloat(s[o]))?"":parseFloat(s[o])*100);e.table.filter.search[l].val=i.join(",")}return e.onTableHeaderAction("refresh",{event:"com-search",data:e.table.filter.search}),!1}},e.mount(),e.getData(),P("baTable",e);const p=D(a=>{a&&F(a)>0?G(a).then(l=>{r.userInfo=l.data.user}):r.userInfo={}},300),h=a=>{e.table.filter||(e.table.filter={search:[]}),Array.isArray(e.table.filter.search)||(e.table.filter.search=[]),e.table.filter.search=e.table.filter.search.filter(l=>l.field!=="field_type"),a&&e.table.filter.search.push({field:"field_type",val:a,operator:"="}),e.onTableHeaderAction("refresh",{event:"field-type-filter"})};return p(e.comSearch.form.user_id),N(()=>e.comSearch.form.user_id,a=>{e.form.defaultItems.user_id=a,p(a)}),(a,l)=>{const s=n("el-alert"),i=n("el-button"),o=n("el-option"),v=n("el-select"),y=n("el-tooltip"),g=A("blur");return d(),C("div",q,[b(e).table.remark?(d(),m(s,{key:0,class:"ba-table-alert",title:b(e).table.remark,type:"info","show-icon":""},null,8,["title"])):u("",!0),t(H,{buttons:["refresh","add","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":"快速搜索：用户名/用户昵称"},{default:c(()=>[b(S)(r.userInfo)?u("",!0):E((d(),m(i,{key:0,class:"table-header-operate"},{default:c(()=>[f("span",K,x(r.userInfo.username+"(ID:"+r.userInfo.id+") | 可用余额:"+r.userInfo.balance_available+" | 总资产:"+r.userInfo.money),1)]),_:1})),[[g]]),f("div",O,[t(y,{content:"筛选资金类型",placement:"top"},{default:c(()=>[t(v,{modelValue:r.selectedFieldType,"onUpdate:modelValue":l[0]||(l[0]=w=>r.selectedFieldType=w),onChange:h,placeholder:"全部类型",clearable:"",style:{width:"150px"}},{default:c(()=>[t(o,{label:"全部类型",value:""}),t(o,{label:"可用金额",value:"money"}),t(o,{label:"可提现金额",value:"withdrawable_money"}),t(o,{label:"确权金",value:"service_fee_balance"}),t(o,{label:"拓展提现",value:"static_income"}),t(o,{label:"待激活确权金",value:"pending_activation_gold"}),t(o,{label:"消费金",value:"score"})]),_:1},8,["modelValue"])]),_:1})])]),_:1}),t(L),t(B)])}}});export{ee as default};
