import{e as H,f as V,c as h}from"./index-DRv2sWQF.js";import{B as I,am as M,b,l as C,I as i,Z as w,O as m,D as n,P as a,_ as F,G as k,F as U,u as t,U as f,H as s,C as D,V as O,W as P,$ as p,X,a1 as u}from"./vue-BMJJ5Kg4.js";const Z={class:"title"},q={style:{display:"flex",gap:"10px","flex-wrap":"wrap"}},ee=I({__name:"popupForm",setup(J){const x=H(),e=M("baTable"),g=b(""),_=b(!1),v=b(!1),B=C(()=>{const l=e.form.items.status;return l===0?"待审核":l===1?"已采纳":"已拒绝"}),T=C(()=>{const l=e.form.items.status;return l===0?"warning":l===1?"success":"danger"}),j=async()=>{_.value=!0;try{const l=await h({url:"/admin/user.UserQuestionnaire/adopt",method:"post",data:{ids:e.form.items.id,admin_remark:g.value}});l.code===1?(u.success(l.msg||"采纳成功"),e.toggleForm(""),e.getData()):u.error(l.msg||"操作失败")}catch(l){u.error(l.msg||"请求失败")}finally{_.value=!1}},N=async()=>{v.value=!0;try{const l=await h({url:"/admin/user.UserQuestionnaire/reject",method:"post",data:{ids:e.form.items.id,admin_remark:g.value}});l.code===1?(u.success(l.msg||"已拒绝"),e.toggleForm(""),e.getData()):u.error(l.msg||"操作失败")}catch(l){u.error(l.msg||"请求失败")}finally{v.value=!1}};return(l,o)=>{const c=i("el-input"),d=i("el-form-item"),W=i("el-image"),z=i("el-tag"),A=i("el-form"),E=i("el-scrollbar"),y=i("el-button"),L=i("el-dialog"),R=w("drag"),Q=w("zoom"),S=w("loading");return n(),m(L,{class:"ba-operate-dialog","close-on-click-modal":!1,"model-value":["Add","Edit"].includes(t(e).form.operate),onClose:t(e).toggleForm},{header:a(()=>[F((n(),D("div",Z,o[4]||(o[4]=[p(" 问卷详情 ")]))),[[R,[".ba-operate-dialog",".el-dialog__header"]],[Q,".ba-operate-dialog"]])]),footer:a(()=>[k("div",{style:U("width: calc(100% - "+t(e).form.labelWidth/1.8+"px)")},[s(y,{onClick:o[3]||(o[3]=r=>t(e).toggleForm(""))},{default:a(()=>o[5]||(o[5]=[p("关闭")])),_:1}),t(e).form.items.status===0?(n(),m(y,{key:0,type:"danger",loading:v.value,onClick:N},{default:a(()=>o[6]||(o[6]=[p(" 拒绝 ")])),_:1},8,["loading"])):f("",!0),t(e).form.items.status===0?(n(),m(y,{key:1,type:"success",loading:_.value,onClick:j},{default:a(()=>o[7]||(o[7]=[p(" 采纳并奖励 ")])),_:1},8,["loading"])):f("",!0)],4)]),default:a(()=>[F((n(),m(E,{class:"ba-table-form-scrollbar"},{default:a(()=>[k("div",{class:"ba-operate-form",style:U(t(x).layout.shrink?"":"width: calc(100% - "+t(e).form.labelWidth/2+"px)")},[t(e).form.loading?f("",!0):(n(),m(A,{key:0,ref:"formRef",model:t(e).form.items,"label-position":t(x).layout.shrink?"top":"right","label-width":t(e).form.labelWidth+"px"},{default:a(()=>[s(d,{label:"用户"},{default:a(()=>{var r;return[s(c,{"model-value":((r=t(e).form.items.user)==null?void 0:r.username)||t(e).form.items.user_id,readonly:""},null,8,["model-value"])]}),_:1}),s(d,{label:"标题"},{default:a(()=>[s(c,{modelValue:t(e).form.items.title,"onUpdate:modelValue":o[0]||(o[0]=r=>t(e).form.items.title=r),readonly:""},null,8,["modelValue"])]),_:1}),s(d,{label:"内容"},{default:a(()=>[s(c,{modelValue:t(e).form.items.content,"onUpdate:modelValue":o[1]||(o[1]=r=>t(e).form.items.content=r),type:"textarea",rows:6,readonly:""},null,8,["modelValue"])]),_:1}),t(e).form.items.images?(n(),m(d,{key:0,label:"凭证图片"},{default:a(()=>[k("div",q,[(n(!0),D(O,null,P(t(e).form.items.images.split(","),(r,$)=>(n(),m(W,{key:$,src:t(V)(r),"preview-src-list":t(e).form.items.images.split(",").map(G=>t(V)(G)),style:{width:"100px",height:"100px","border-radius":"4px"},fit:"cover"},null,8,["src","preview-src-list"]))),128))])]),_:1})):f("",!0),s(d,{label:"当前状态"},{default:a(()=>[s(z,{type:T.value},{default:a(()=>[p(X(B.value),1)]),_:1},8,["type"])]),_:1}),t(e).form.items.reward_power>0?(n(),m(d,{key:1,label:"已奖励算力"},{default:a(()=>[s(c,{"model-value":t(e).form.items.reward_power,readonly:""},null,8,["model-value"])]),_:1})):f("",!0),s(d,{label:"管理员备注"},{default:a(()=>[s(c,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=r=>g.value=r),type:"textarea",rows:3,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","label-position","label-width"]))],4)]),_:1})),[[S,t(e).form.loading]])]),_:1},8,["model-value","onClose"])}}});export{ee as _};
