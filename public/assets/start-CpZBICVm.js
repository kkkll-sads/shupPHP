import{B as K,aa as C,a as V,I as m,Z as M,C as R,D as p,G as l,X as s,u as e,H as c,P as n,O as f,$ as i,U as _,a9 as v,a8 as S,V as Q,_ as U,z}from"./vue-BMJJ5Kg4.js";import{e as y,s as d,j as G}from"./index-DkrwL2PO.js";import{F as q}from"./index-BuGVnaur.js";import{b as H}from"./validate-Dn7fuoi2.js";import{_ as O}from"./log.vue_vue_type_style_index_0_lang-FKuNnmot.js";import{v as X,at as Y,au as Z,_ as A}from"./index-BHof7fb5.js";import"./index-KGgu4aSr.js";import"./index-CY3WncDq.js";import"./baTable-C5P52-5P.js";import"./index-1f7Hqibh.js";import"./baAccount-CWf-KCa-.js";import"./index-DPmL6Jt2.js";const J={class:"default-main"},W={class:"crud-title"},ee={class:"start-opt"},te={class:"start-item-title"},ae={class:"start-item-remark"},le={class:"start-item suspension"},se={class:"start-item-title"},re={class:"start-item-remark"},oe={class:"start-item suspension"},de={class:"start-item-title"},ne={class:"start-item-remark"},ce={target:"_blank",href:"https://doc.buildadmin.com/guide/other/developerMustSee.html",rel:"noopener noreferrer"},ie={target:"_blank",href:"https://doc.buildadmin.com/guide/other/developerMustSee.html",rel:"noopener noreferrer"},ue={style:{width:"calc(100% * 0.9)"}},pe=K({__name:"start",setup(me){const{t}=X.useI18n(),k=C("formRef"),L=C("sqlInputRef"),r=V({dialog:{type:"",visible:!1},showLog:!1,loading:!1,successRecord:0}),$=u=>{r.dialog.type=u,r.dialog.visible=!0,r.successRecord=0,d.startData.table=""},I=V({table:[H({name:"required",message:t("crud.crud.Please select a data table")})]}),g=()=>{var u;if(r.dialog.type=="sql"&&!d.startData.sql){z({type:"error",message:t("crud.crud.Please enter the table creation SQL")});return}(u=k.value)==null||u.validate(a=>{a&&y(r.dialog.type)})},P=()=>{r.successRecord=0,d.startData.table=""},T=()=>{d.startData.table&&(r.loading=!0,G(d.startData.table,d.startData.databaseConnection).then(u=>{r.successRecord=u.data.id}).finally(()=>{r.loading=!1}))},N=()=>{r.successRecord&&(d.startData.logId=r.successRecord.toString(),y("log"))},B=()=>!1;return(u,a)=>{const b=m("el-col"),D=m("el-row"),w=m("el-alert"),F=m("el-input"),j=m("el-form"),h=m("el-button"),E=m("el-dialog"),x=M("blur");return p(),R("div",J,[l("div",W,s(e(t)("crud.crud.start")),1),l("div",ee,[c(D,{gutter:20},{default:n(()=>[c(b,{xs:24,span:8},{default:n(()=>[l("div",{onClick:a[0]||(a[0]=o=>e(y)("create")),class:"start-item suspension"},[l("div",te,s(e(t)("crud.crud.create")),1),l("div",ae,s(e(t)("crud.crud.New background CRUD from zero")),1)])]),_:1}),c(b,{onClick:a[1]||(a[1]=o=>$("db")),xs:24,span:8},{default:n(()=>[l("div",le,[l("div",se,s(e(t)("crud.crud.Select Data Table")),1),l("div",re,s(e(t)("crud.crud.Select a designed data table from the database")),1)])]),_:1}),c(b,{onClick:a[2]||(a[2]=o=>r.showLog=!0),xs:24,span:8},{default:n(()=>[l("div",oe,[l("div",de,s(e(t)("crud.crud.CRUD record")),1),l("div",ne,s(e(t)("crud.crud.Start with previously generated CRUD code")),1)])]),_:1})]),_:1}),c(D,{justify:"center"},{default:n(()=>[c(b,{span:20,class:"ba-markdown crud-tips suspension"},{default:n(()=>[l("b",null,s(e(t)("crud.crud.Fast experience")),1),l("ol",null,[l("li",null,[i(s(e(t)("crud.crud.experience 1 1"))+" ",1),l("a",ce,s(e(t)("crud.crud.experience 1 2")),1),i(" "+s(e(t)("crud.crud.experience 1 3")),1)]),l("li",null,[i(s(e(t)("crud.crud.experience 2 1"))+" ",1),l("code",null,s(e(t)("crud.crud.experience 2 2")),1),i(" "+s(e(t)("crud.crud.experience 2 3"))+" ",1),a[13]||(a[13]=l("code",null,"test_build",-1)),i(" "+s(e(t)("crud.crud.data sheet")),1)]),l("li",null,[i(s(e(t)("crud.crud.experience 3 1"))+" ",1),l("code",null,s(e(t)("crud.crud.experience 3 2")),1),i(" "+s(e(t)("crud.crud.experience 3 3"))+" ",1),l("code",null,s(e(t)("crud.crud.experience 3 4")),1)])]),B()?_("",!0):(p(),f(w,{key:0,class:"no-dev",type:"warning","show-icon":!0,closable:!1},{title:n(()=>[l("span",null,s(e(t)("crud.crud.experience 4 1")),1),l("a",ie,s(e(t)("crud.crud.experience 4 2")),1),l("span",null,[i(s(e(t)("crud.crud.experience 4 3")),1),l("code",null,s(e(t)("crud.crud.experience 4 4")),1)])]),_:1}))]),_:1})]),_:1}),c(E,{class:"ba-operate-dialog select-table-dialog",modelValue:r.dialog.visible,"onUpdate:modelValue":a[11]||(a[11]=o=>r.dialog.visible=o),title:r.dialog.type=="sql"?e(t)("crud.crud.Please enter SQL"):e(t)("crud.crud.Please select a data table"),"destroy-on-close":!0},{footer:n(()=>[l("div",ue,[c(h,{onClick:a[9]||(a[9]=o=>r.dialog.visible=!1)},{default:n(()=>[i(s(u.$t("Cancel")),1)]),_:1}),U((p(),f(h,{loading:r.loading,onClick:a[10]||(a[10]=o=>g()),type:"primary"},{default:n(()=>[i(s(e(t)("Confirm")),1)]),_:1},8,["loading"])),[[x]]),r.successRecord?U((p(),f(h,{key:0,onClick:N,type:"success"},{default:n(()=>[i(s(e(t)("crud.crud.Start with the historical record")),1)]),_:1})),[[x]]):_("",!0)])]),default:n(()=>[c(j,{"label-width":140,onKeyup:a[8]||(a[8]=v(o=>g(),["enter"])),class:"select-table-form",ref_key:"formRef",ref:k,model:e(d).startData,rules:I},{default:n(()=>[r.dialog.type=="sql"?(p(),f(F,{key:0,class:"sql-input",prop:"sql",ref_key:"sqlInputRef",ref:L,modelValue:e(d).startData.sql,"onUpdate:modelValue":a[3]||(a[3]=o=>e(d).startData.sql=o),type:"textarea",placeholder:e(t)("crud.crud.table create SQL"),rows:10,onKeyup:[a[4]||(a[4]=v(S(()=>{},["stop"]),["enter"])),a[5]||(a[5]=v(S(o=>g(),["ctrl"]),["enter"]))]},null,8,["modelValue","placeholder"])):r.dialog.type=="db"?(p(),R(Q,{key:1},[c(q,{label:e(t)("Database connection"),modelValue:e(d).startData.databaseConnection,"onUpdate:modelValue":a[6]||(a[6]=o=>e(d).startData.databaseConnection=o),type:"remoteSelect","label-width":140,"block-help":e(t)("Database connection help"),"input-attr":{pk:"key",field:"key",remoteUrl:e(Y),onChange:P},placeholder:e(t)("Please select field",{field:e(t)("Database connection")})},null,8,["label","modelValue","block-help","input-attr","placeholder"]),(p(),f(q,{label:e(t)("crud.crud.data sheet"),modelValue:e(d).startData.table,"onUpdate:modelValue":a[7]||(a[7]=o=>e(d).startData.table=o),type:"remoteSelect",key:e(d).startData.databaseConnection,placeholder:e(t)("crud.crud.Please select a data table"),"label-width":140,"block-help":e(t)("crud.crud.data sheet help"),"input-attr":{pk:"table",field:"comment",params:{connection:e(d).startData.databaseConnection,samePrefix:1,excludeTable:["area","token","captcha","admin_group_access","config","admin_log","user_money_log","user_score_log"]},remoteUrl:e(Z),onRow:T},prop:"table"},null,8,["label","modelValue","placeholder","block-help","input-attr"])),r.successRecord?(p(),f(w,{key:0,class:"success-record-alert",title:e(t)("crud.crud.The selected table has already generated records You are advised to start with historical records"),"show-icon":!0,closable:!1,type:"warning"},null,8,["title"])):_("",!0)],64)):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),c(O,{modelValue:r.showLog,"onUpdate:modelValue":a[12]||(a[12]=o=>r.showLog=o)},null,8,["modelValue"])])])}}}),Ve=A(pe,[["__scopeId","data-v-92477540"]]);export{Ve as default};
