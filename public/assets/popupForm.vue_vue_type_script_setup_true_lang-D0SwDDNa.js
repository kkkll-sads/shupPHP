import{B as $,am as j,b as K,w,I as n,Z as V,O as b,D as c,P as a,_ as q,G as m,F as P,u as o,a0 as R,U as z,a9 as W,H as r,$ as p,X as v,C as A}from"./vue-DnSQgQf0.js";import{v as G,e as H}from"./index-BR6nH71S.js";import{F as u}from"./index-Ch43UxRl.js";const O={class:"title"},X={class:"dialog-footer"},Q=$({__name:"popupForm",setup(Z){const e=j("baTable"),{t:f}=G.useI18n(),k=H(),_=K();w(()=>{var s;return(s=e.form.items)==null?void 0:s.is_physical},s=>{s==="1"&&e.form.items&&(e.form.items.is_card_product="0"),s==="0"&&e.form.items&&!e.form.items.is_card_product&&(e.form.items.is_card_product="0")}),w([()=>{var s;return(s=e.form.items)==null?void 0:s.price},()=>{var s;return(s=e.form.items)==null?void 0:s.score_price}],([s,t])=>{if(e.form.items){const d=parseFloat(s||0),i=parseInt(t||0);d>0&&i>0?e.form.items.purchase_type="both":d>0&&i===0?e.form.items.purchase_type="money":d===0&&i>0&&(e.form.items.purchase_type="score")}});const B={name:[{required:!0,message:"商品名称不能为空",trigger:"blur"}],price:[{required:!0,message:"可用金额单价不能为空",trigger:"change"}],score_price:[{required:!0,message:"消费金数量不能为空",trigger:"change"}],stock:[{required:!0,message:"库存数量不能为空",trigger:"change"}],purchase_type:[{required:!0,message:"购买方式不能为空",trigger:"change"}],is_physical:[{required:!0,message:"商品类型不能为空",trigger:"change"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]};return(s,t)=>{const d=n("el-input"),i=n("el-form-item"),g=n("el-input-number"),x=n("el-alert"),D=n("el-form"),I=n("el-scrollbar"),U=n("el-button"),S=n("el-dialog"),E=V("drag"),N=V("zoom"),T=V("loading");return c(),b(S,{class:"ba-operate-dialog","close-on-click-modal":!1,"destroy-on-close":!0,"model-value":["Add","Edit"].includes(o(e).form.operate),onClose:o(e).toggleForm},{header:a(()=>[q((c(),A("div",O,[p(v(o(e).form.operate?o(f)(String(o(e).form.operate)):""),1)])),[[E,[".ba-operate-dialog",".el-dialog__header"]],[N,".ba-operate-dialog"]])]),footer:a(()=>[m("div",X,[r(U,{onClick:o(e).toggleForm},{default:a(()=>[p(v(o(f)("Cancel")),1)]),_:1},8,["onClick"]),r(U,{type:"primary",onClick:t[14]||(t[14]=y=>o(e).onSubmit(_.value))},{default:a(()=>[p(v(o(f)("Confirm")),1)]),_:1})])]),default:a(()=>[q((c(),b(I,{class:"ba-table-form-scrollbar"},{default:a(()=>{var y,C,h,F;return[m("div",{class:R(["ba-operate-form","ba-"+o(e).form.operate+"-form"]),style:P((C=(y=o(k))==null?void 0:y.layout)!=null&&C.shrink?"":"width: calc(100% - "+(o(e).form.labelWidth||160)/2+"px)")},[o(e).form.loading?z("",!0):(c(),b(D,{key:0,ref_key:"formRef",ref:_,onKeyup:t[13]||(t[13]=W(l=>o(e).onSubmit(_.value),["enter"])),model:o(e).form.items,"label-position":(F=(h=o(k))==null?void 0:h.layout)!=null&&F.shrink?"top":"right","label-width":(o(e).form.labelWidth||160)+"px",rules:B},{default:a(()=>[r(i,{prop:"name",label:"商品名称"},{default:a(()=>[r(d,{modelValue:o(e).form.items.name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(e).form.items.name=l),type:"string",placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),r(u,{label:"商品缩略图",type:"image",modelValue:o(e).form.items.thumbnail,"onUpdate:modelValue":t[1]||(t[1]=l=>o(e).form.items.thumbnail=l),prop:"thumbnail","input-attr":{returnFullUrl:!0,limit:1}},null,8,["modelValue"]),r(u,{label:"商品图片",type:"image",modelValue:o(e).form.items.images,"onUpdate:modelValue":t[2]||(t[2]=l=>o(e).form.items.images=l),prop:"images","input-attr":{returnFullUrl:!0,limit:9}},null,8,["modelValue"]),r(i,{prop:"description",label:"商品描述"},{default:a(()=>[r(d,{modelValue:o(e).form.items.description,"onUpdate:modelValue":t[3]||(t[3]=l=>o(e).form.items.description=l),type:"textarea",rows:4,placeholder:"请输入商品详细描述"},null,8,["modelValue"])]),_:1}),r(i,{prop:"category",label:"商品分类"},{default:a(()=>[r(d,{modelValue:o(e).form.items.category,"onUpdate:modelValue":t[4]||(t[4]=l=>o(e).form.items.category=l),type:"string",placeholder:"请输入商品分类"},null,8,["modelValue"])]),_:1}),r(i,{prop:"price",label:"可用金额单价"},{default:a(()=>[r(g,{modelValue:o(e).form.items.price,"onUpdate:modelValue":t[5]||(t[5]=l=>o(e).form.items.price=l),min:0,step:.01,precision:2,"controls-position":"right",placeholder:"请输入可用金额价格"},null,8,["modelValue"]),t[15]||(t[15]=m("span",{style:{"margin-left":"10px",color:"#999"}},"元",-1))]),_:1}),r(i,{prop:"score_price",label:"消费金数量"},{default:a(()=>[r(g,{modelValue:o(e).form.items.score_price,"onUpdate:modelValue":t[6]||(t[6]=l=>o(e).form.items.score_price=l),min:0,"controls-position":"right",placeholder:"请输入消费金数量，0表示仅可用金额购买"},null,8,["modelValue"]),t[16]||(t[16]=m("span",{style:{"margin-left":"10px",color:"#999"}},"消费金",-1))]),_:1}),r(i,{prop:"stock",label:"库存数量"},{default:a(()=>[r(g,{modelValue:o(e).form.items.stock,"onUpdate:modelValue":t[7]||(t[7]=l=>o(e).form.items.stock=l),min:0,"controls-position":"right",placeholder:"请输入库存数量"},null,8,["modelValue"])]),_:1}),r(u,{label:"购买方式",modelValue:o(e).form.items.purchase_type,"onUpdate:modelValue":t[8]||(t[8]=l=>o(e).form.items.purchase_type=l),type:"radio",prop:"purchase_type","input-attr":{border:!0,content:{money:"余额购买",score:"消费金购买",both:"组合支付"},disabled:!0}},{append:a(()=>[r(x,{type:"info",closable:!1,style:{"margin-top":"5px"}},{title:a(()=>t[17]||(t[17]=[m("span",{style:{"font-size":"12px"}},[p("购买方式自动设置："),m("br"),p(" • 仅设置可用金额单价：仅余额购买"),m("br"),p(" • 仅设置消费金数量：仅消费金购买"),m("br"),p(" • 同时设置两种价格：强制组合支付"),m("br"),p(" • 不可手动修改，由系统自动管理 ")],-1)])),_:1})]),_:1},8,["modelValue"]),r(u,{label:"商品类型",modelValue:o(e).form.items.is_physical,"onUpdate:modelValue":t[9]||(t[9]=l=>o(e).form.items.is_physical=l),type:"radio",prop:"is_physical","input-attr":{border:!0,content:{1:"实物商品",0:"虚拟商品"}}},null,8,["modelValue"]),o(e).form.items.is_physical==="0"?(c(),b(u,{key:0,label:"是否卡密商品",modelValue:o(e).form.items.is_card_product,"onUpdate:modelValue":t[10]||(t[10]=l=>o(e).form.items.is_card_product=l),type:"radio",prop:"is_card_product","input-attr":{border:!0,content:{0:"否",1:"是"}}},{append:a(()=>[r(x,{type:"info",closable:!1,style:{"margin-top":"5px"}},{title:a(()=>t[18]||(t[18]=[m("span",{style:{"font-size":"12px"}},"卡密商品：管理员填写备注后订单自动标记为已发货",-1)])),_:1})]),_:1},8,["modelValue"])):z("",!0),r(u,{label:"状态",modelValue:o(e).form.items.status,"onUpdate:modelValue":t[11]||(t[11]=l=>o(e).form.items.status=l),type:"radio",prop:"status","input-attr":{border:!0,content:{1:o(f)("Enable"),0:o(f)("Disable")}}},null,8,["modelValue","input-attr"]),r(i,{prop:"sort",label:"排序"},{default:a(()=>[r(g,{modelValue:o(e).form.items.sort,"onUpdate:modelValue":t[12]||(t[12]=l=>o(e).form.items.sort=l),min:0,max:9999,"controls-position":"right",placeholder:"请输入排序值"},null,8,["modelValue"]),t[19]||(t[19]=m("span",{style:{"margin-left":"10px",color:"#999"}},"数值越大越靠前",-1))]),_:1})]),_:1},8,["model","label-position","label-width"]))],6)]}),_:1})),[[T,o(e).form.loading]])]),_:1},8,["model-value","onClose"])}}});export{Q as _};
