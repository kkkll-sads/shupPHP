import{b as q,d as H}from"./baTable-57jWdOQZ.js";import{_ as K}from"./popupForm.vue_vue_type_script_setup_true_lang-BjrIx1tM.js";import{T as M,a as O}from"./index-DONpsK3B.js";import{a5 as j}from"./index-DRv2sWQF.js";import{F as z}from"./index-Dy1MJO1N.js";import{B as X,b as m,I as o,Z,C as A,D as _,O as y,U as J,H as t,u as B,P as a,G as i,_ as Q,$ as d,X as V,a1 as v,ai as Y,at as ee}from"./vue-BMJJ5Kg4.js";import"./index-CqVz8jMs.js";const te={class:"default-main ba-table-box"},le={class:"title"},ae={class:"ba-detail-content"},oe={class:"work-header"},re={key:1},se={class:"dialog-footer"},ne={class:"ba-operate-form"},ie={class:"dialog-footer"},ve=X({name:"content/artist",__name:"index",setup(de){const n=new q(new j("/admin/content.Artist/"),{column:[{type:"selection",align:"center",operator:!1},{label:"ID",prop:"id",align:"center",operator:"=",operatorPlaceholder:"ID",width:70},{label:"姓名",prop:"name",align:"center",operator:"LIKE",operatorPlaceholder:"姓名"},{label:"头像",prop:"image",align:"center",operator:!1,render:"image"},{label:"头衔",prop:"title",align:"center",operator:"LIKE",operatorPlaceholder:"头衔"},{label:"状态",prop:"status",align:"center",operator:"IN",operatorPlaceholder:"状态",render:"switch",replaceValue:{0:"禁用",1:"启用"}},{label:"排序",prop:"sort",align:"center",operator:"RANGE",operatorPlaceholder:"排序",width:80,sortable:"custom"},{label:"创建时间",prop:"create_time",align:"center",operator:"RANGE",operatorPlaceholder:"创建时间",width:160,render:"datetime",sortable:"custom"},{label:"更新时间",prop:"update_time",align:"center",operator:"RANGE",operatorPlaceholder:"更新时间",width:160,render:"datetime",sortable:"custom"},{label:"操作",prop:"operate",align:"center",width:260,render:"buttons",buttons:[...H(["edit","delete"]),{render:"basicButton",name:"artistWork",type:"primary",icon:"fa fa-image",text:"作品管理",click:s=>E(s)}],operator:!1}]},{defaultItems:{}}),g=m(!1),u=m(null),h=m([]),w=m(!1),c=m(!1),r=m({title:"",image:"",description:"",sort:0,status:"1"}),E=async s=>{u.value=s,await k(),g.value=!0},k=async()=>{if(u.value){w.value=!0;try{const s=await n.api.postData("read",{id:u.value.id});h.value=s.data.works||[]}catch{}finally{w.value=!1}}},N=()=>{r.value={title:"",image:"",description:"",sort:0,status:"1"},c.value=!0},P=async()=>{if(u.value)try{await n.api.postData("addWork",{artist_id:u.value.id,...r.value}),v.success("作品已添加"),c.value=!1,await k()}catch(s){v.error((s==null?void 0:s.msg)||"添加失败")}},T=s=>{Y.confirm("确认删除该作品吗？","提示",{type:"warning"}).then(async()=>{try{await n.api.postData("delWork",{ids:[s.id]}),v.success("删除成功"),await k()}catch(e){v.error((e==null?void 0:e.msg)||"删除失败")}}).catch(()=>{})};return n.mount(),n.getData(),ee("baTable",n),(s,e)=>{const U=o("el-alert"),b=o("el-button"),p=o("el-table-column"),W=o("el-image"),$=o("el-tag"),F=o("el-table"),x=o("el-scrollbar"),D=o("el-dialog"),C=o("el-input"),f=o("el-form-item"),G=o("el-input-number"),I=o("el-radio"),L=o("el-radio-group"),R=o("el-form"),S=Z("loading");return _(),A("div",te,[B(n).table.remark?(_(),y(U,{key:0,class:"ba-table-alert",title:B(n).table.remark,type:"info","show-icon":""},null,8,["title"])):J("",!0),t(M,{buttons:["refresh","add","edit","delete","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":"快速搜索：姓名/ID"}),t(O),t(K),t(D,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),class:"ba-detail-dialog","close-on-click-modal":!1,"destroy-on-close":!0,width:"70%"},{header:a(()=>{var l;return[i("div",le," 艺术家作品管理："+V(((l=u.value)==null?void 0:l.name)||""),1)]}),footer:a(()=>[i("div",se,[t(b,{onClick:e[0]||(e[0]=l=>g.value=!1)},{default:a(()=>e[11]||(e[11]=[d("关闭")])),_:1})])]),default:a(()=>[t(x,{class:"ba-detail-scrollbar"},{default:a(()=>[i("div",ae,[i("div",oe,[t(b,{type:"primary",onClick:N},{default:a(()=>e[9]||(e[9]=[d("新增作品")])),_:1})]),Q((_(),y(F,{data:h.value,stripe:""},{default:a(()=>[t(p,{prop:"id",label:"ID",width:"70",align:"center"}),t(p,{label:"作品图",width:"120",align:"center"},{default:a(({row:l})=>[l.image?(_(),y(W,{key:0,src:l.image,style:{width:"80px",height:"80px","object-fit":"cover"},"preview-src-list":[l.image]},null,8,["src","preview-src-list"])):(_(),A("span",re,"-"))]),_:1}),t(p,{prop:"title",label:"作品名称",align:"center"}),t(p,{prop:"status",label:"状态",width:"100",align:"center"},{default:a(({row:l})=>[t($,{type:l.status==="1"?"success":"info"},{default:a(()=>[d(V(l.status==="1"?"显示":"隐藏"),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"sort",label:"排序",width:"80",align:"center"}),t(p,{label:"作品描述",align:"left","min-width":"200"},{default:a(({row:l})=>[i("span",null,V(l.description||"-"),1)]),_:1}),t(p,{label:"操作",width:"120",align:"center"},{default:a(({row:l})=>[t(b,{type:"danger",size:"small",onClick:pe=>T(l)},{default:a(()=>e[10]||(e[10]=[d("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[S,w.value]])])]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=l=>c.value=l),class:"ba-operate-dialog","close-on-click-modal":!1,"destroy-on-close":!0,width:"600px"},{header:a(()=>e[12]||(e[12]=[i("div",{class:"title"}," 新增作品 ",-1)])),footer:a(()=>[i("div",ie,[t(b,{onClick:e[7]||(e[7]=l=>c.value=!1)},{default:a(()=>e[15]||(e[15]=[d("取消")])),_:1}),t(b,{type:"primary",onClick:P},{default:a(()=>e[16]||(e[16]=[d("确定")])),_:1})])]),default:a(()=>[t(x,{class:"ba-table-form-scrollbar"},{default:a(()=>[i("div",ne,[t(R,{ref:"workFormRef",model:r.value,"label-width":"90px"},{default:a(()=>[t(f,{label:"作品名称",prop:"title"},{default:a(()=>[t(C,{modelValue:r.value.title,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.title=l),placeholder:"请输入作品名称"},null,8,["modelValue"])]),_:1}),t(f,{label:"作品图片",prop:"image"},{default:a(()=>[t(z,{label:"",type:"image",modelValue:r.value.image,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.image=l),prop:"image",placeholder:"请上传作品图片"},null,8,["modelValue"])]),_:1}),t(f,{label:"排序",prop:"sort"},{default:a(()=>[t(G,{modelValue:r.value.sort,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.sort=l),min:0,max:999,"controls-position":"right",placeholder:"排序值，越大越靠前"},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:a(()=>[t(L,{modelValue:r.value.status,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value.status=l)},{default:a(()=>[t(I,{label:"1"},{default:a(()=>e[13]||(e[13]=[d("显示")])),_:1}),t(I,{label:"0"},{default:a(()=>e[14]||(e[14]=[d("隐藏")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"作品描述",prop:"description"},{default:a(()=>[t(C,{modelValue:r.value.description,"onUpdate:modelValue":e[6]||(e[6]=l=>r.value.description=l),type:"textarea",rows:4,placeholder:"请输入作品详情描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["modelValue"])])}}});export{ve as default};
