import{b as m,d as b}from"./baTable-57jWdOQZ.js";import f from"./popupForm-Z8sYk8Up.js";import{T as h,a as g}from"./index-DONpsK3B.js";import{v as _,a5 as y}from"./index-DRv2sWQF.js";import{B,I as T,C as k,D as s,O as x,U as v,H as c,u as l,ai as p,a1 as n,at as E}from"./vue-BMJJ5Kg4.js";import"./index-CqVz8jMs.js";const w={class:"default-main ba-table-box"},H=B({name:"collection/order",__name:"index",setup(I){const{t:a}=_.useI18n(),t=new m(new y("/admin/collection.Order/"),{column:[{type:"selection",align:"center",operator:!1},{label:a("Id"),prop:"id",align:"center",operator:"=",operatorPlaceholder:a("Id"),width:70},{label:"订单号",prop:"order_no",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query")},{label:"用户ID",prop:"user_id",align:"center",operator:"="},{label:"订单金额",prop:"total_amount",align:"center",operator:"BETWEEN",render:e=>{const o=Number(e.total_amount);return isNaN(o)?e.total_amount:o.toFixed(2)+"元"}},{label:"支付方式",prop:"pay_type",align:"center",render:"tag",operator:"select",operatorOptions:[{label:"余额支付",value:"money"},{label:"积分兑换",value:"score"}],replaceValue:{money:"余额支付",score:"积分兑换"}},{label:"订单状态",prop:"status",align:"center",render:"tag",operator:"select",operatorOptions:[{label:"待支付",value:"pending"},{label:"已支付",value:"paid"},{label:"已完成",value:"completed"},{label:"已取消",value:"cancelled"},{label:"已退款",value:"refunded"}],replaceValue:{pending:"待支付",paid:"已支付",completed:"已完成",cancelled:"已取消",refunded:"已退款"},custom:{pending:"info",paid:"warning",completed:"success",cancelled:"info",refunded:"danger"}},{label:"支付时间",prop:"pay_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160},{label:"完成时间",prop:"complete_time",align:"center",render:"datetime",operator:"RANGE",width:160},{label:a("Create time"),prop:"create_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160},{label:a("Operate"),prop:"operate",align:"center",width:200,render:"buttons",buttons:[],operator:!1}]},{defaultItems:{}}),i={render:"tipButton",name:"complete",text:"完成",type:"success",icon:"fa fa-check-circle",title:"完成订单",display:e=>e.status==="paid",class:"table-row-complete",click:e=>{p.confirm("确认该订单已完成？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(()=>{t.api.postData("complete",{id:e.id}).then(()=>{n.success("订单已完成"),t.onTableHeaderAction("refresh",{})}).catch(o=>{n.error(o.msg||"操作失败")})}).catch(()=>{})}},d={render:"tipButton",name:"cancel",text:"取消订单",type:"danger",icon:"fa fa-ban",title:"取消订单",display:e=>["pending","paid"].includes(e.status),class:"table-row-cancel",click:e=>{p.confirm("确定要取消该订单吗？如已支付将自动退款并恢复库存。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.api.postData("cancel",{id:e.id}).then(()=>{n.success("取消订单成功"),t.onTableHeaderAction("refresh",{})}).catch(o=>{n.error(o.msg||"取消订单失败")})}).catch(()=>{})}},r=b(["edit"]);return r.push(i),r.push(d),r.forEach(e=>{e.name==="edit"&&(e.display=()=>!0)}),t.table.column[t.table.column.length-1].buttons=r,t.mount(),t.getData(),E("baTable",t),(e,o)=>{const u=T("el-alert");return s(),k("div",w,[l(t).table.remark?(s(),x(u,{key:0,class:"ba-table-alert",title:l(t).table.remark,type:"info","show-icon":""},null,8,["title"])):v("",!0),c(h,{buttons:["refresh","edit","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":l(a)("Quick search placeholder",{fields:"订单号/"+l(a)("Id")})},null,8,["quick-search-placeholder"]),c(g),c(f)])}}});export{H as default};
