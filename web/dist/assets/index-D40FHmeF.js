import{B as A,b as g,o as E,a as G,I as i,Z as K,C as D,D as c,O as p,U as w,H as e,P as t,V as L,W as M,G as u,_ as S,$ as m,X as v,u as H,aK as N}from"./vue-BMJJ5Kg4.js";import{c as T,_ as O}from"./index-DRv2sWQF.js";const P={class:"default-main ba-table-box"},W={style:{display:"flex","justify-content":"space-between","align-items":"center"}},X={style:{color:"#409eff"}},Z={style:{display:"flex","justify-content":"space-between","align-items":"center"}},$={style:{color:"#67c23a"}},q=A({name:"collection/tradeHall",__name:"index",setup(J){const _=g(!1),d=g(0),f=g([]),n=g([]),s=g([]),h=async()=>{_.value=!0;try{const r=await T({url:"/admin/collection.TradeHall/index",method:"get",params:{session_id:d.value>0?d.value:void 0}});if(r.code===1&&r.data&&(f.value=r.data.sessions||[],n.value=r.data.reservation_stats||[],s.value=r.data.consignment_stats||[],n.value.length>0&&(console.log("预约统计数据示例:",n.value[0]),console.log("是否包含 item_count:","item_count"in n.value[0]),console.log("item_count 值:",n.value[0].item_count)),s.value.length>0&&(console.log("寄售统计数据示例:",s.value[0]),console.log("是否包含 item_count:","item_count"in s.value[0]),console.log("item_count 值:",s.value[0].item_count)),d.value<=0&&f.value.length>0)){d.value=f.value[0].id;const l=await T({url:"/admin/collection.TradeHall/index",method:"get",params:{session_id:d.value}});l.code===1&&l.data&&(n.value=l.data.reservation_stats||[],s.value=l.data.consignment_stats||[],n.value.length>0&&(console.log("预约统计数据示例（重新获取）:",n.value[0]),console.log("是否包含 item_count:","item_count"in n.value[0])),s.value.length>0&&(console.log("寄售统计数据示例（重新获取）:",s.value[0]),console.log("是否包含 item_count:","item_count"in s.value[0])))}}catch(r){console.error("获取数据失败:",r)}finally{_.value=!1}},j=()=>{h()};E(()=>{h()});const x=G({table:{remark:""}});return(r,l)=>{const F=i("el-alert"),I=i("el-option"),U=i("el-select"),y=i("el-card"),k=i("el-icon"),C=i("el-button"),o=i("el-table-column"),b=i("el-tag"),V=i("el-table"),z=i("el-empty"),B=K("loading");return c(),D("div",P,[x.table.remark?(c(),p(F,{key:0,class:"ba-table-alert",title:x.table.remark,type:"info","show-icon":""},null,8,["title"])):w("",!0),e(y,{shadow:"never",style:{"margin-bottom":"15px"}},{header:t(()=>l[1]||(l[1]=[u("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[u("span",{style:{"font-weight":"bold"}},"场次选择")],-1)])),default:t(()=>[e(U,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=a=>d.value=a),placeholder:"请选择场次",style:{width:"300px"},onChange:j},{default:t(()=>[(c(!0),D(L,null,M(f.value,a=>(c(),p(I,{key:a.id,label:a.title,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(y,{shadow:"never",style:{"margin-bottom":"15px"}},{header:t(()=>[u("div",W,[l[3]||(l[3]=u("span",{style:{"font-weight":"bold"}},"预约统计（待处理，按资产包+分区）",-1)),e(C,{type:"primary",size:"small",onClick:h},{default:t(()=>[e(k,null,{default:t(()=>[e(H(N))]),_:1}),l[2]||(l[2]=m(" 刷新 "))]),_:1})])]),default:t(()=>[S((c(),p(V,{data:n.value,stripe:"",border:"","max-height":"600"},{default:t(()=>[e(o,{type:"index",label:"序号",align:"center",width:"60"}),e(o,{prop:"session_title",label:"场次",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"package_name",label:"资产包",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"zone_name",label:"价格分区",align:"center",width:"120"}),e(o,{prop:"user_count",label:"人数",align:"center",width:"100"},{default:t(({row:a})=>[e(b,{type:"primary"},{default:t(()=>[m(v(a.user_count||0),1)]),_:2},1024)]),_:1}),e(o,{prop:"item_count",label:"藏品数量",align:"center",width:"100"},{default:t(({row:a})=>[e(b,{type:"success"},{default:t(()=>[m(v(a.item_count||0),1)]),_:2},1024)]),_:1}),e(o,{prop:"reservation_count",label:"待处理数量",align:"center",width:"100"}),e(o,{prop:"total_freeze_amount",label:"冻结金额",align:"center",width:"120"},{default:t(({row:a})=>[u("span",X,"¥"+v((a.total_freeze_amount||0).toFixed(2)),1)]),_:1})]),_:1},8,["data"])),[[B,_.value]]),!_.value&&n.value.length===0?(c(),p(z,{key:0,description:"暂无数据"})):w("",!0)]),_:1}),e(y,{shadow:"never",style:{"margin-bottom":"15px"}},{header:t(()=>[u("div",Z,[l[5]||(l[5]=u("span",{style:{"font-weight":"bold"}},"寄售统计（在售，按资产包+分区）",-1)),e(C,{type:"primary",size:"small",onClick:h},{default:t(()=>[e(k,null,{default:t(()=>[e(H(N))]),_:1}),l[4]||(l[4]=m(" 刷新 "))]),_:1})])]),default:t(()=>[S((c(),p(V,{data:s.value,stripe:"",border:"","max-height":"600"},{default:t(()=>[e(o,{type:"index",label:"序号",align:"center",width:"60"}),e(o,{prop:"session_title",label:"场次",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"package_name",label:"资产包",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"zone_name",label:"价格分区",align:"center",width:"120"}),e(o,{prop:"user_count",label:"人数",align:"center",width:"100"},{default:t(({row:a})=>[e(b,{type:"primary"},{default:t(()=>[m(v(a.user_count||0),1)]),_:2},1024)]),_:1}),e(o,{prop:"item_count",label:"藏品数量",align:"center",width:"100"},{default:t(({row:a})=>[e(b,{type:"success"},{default:t(()=>[m(v(a.item_count||0),1)]),_:2},1024)]),_:1}),e(o,{prop:"consignment_count",label:"在售数量",align:"center",width:"100"}),e(o,{prop:"total_price",label:"在售总价",align:"center",width:"120"},{default:t(({row:a})=>[u("span",$,"¥"+v((a.total_price||0).toFixed(2)),1)]),_:1})]),_:1},8,["data"])),[[B,_.value]]),!_.value&&s.value.length===0?(c(),p(z,{key:0,description:"暂无数据"})):w("",!0)]),_:1})])}}}),Y=O(q,[["__scopeId","data-v-4c8d52c1"]]);export{Y as default};
