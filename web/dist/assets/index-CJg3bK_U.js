import{b,d as _}from"./baTable-C5P52-5P.js";import{_ as h}from"./popupForm.vue_vue_type_script_setup_true_lang-CxqAQAnc.js";import{T as g,a as w}from"./index-CY3WncDq.js";import{v as B,a5 as T}from"./index-BHof7fb5.js";import{B as k,b as s,o as y,I as x,C as v,D as i,O as D,U as z,H as a,u as c,at as I}from"./vue-BMJJ5Kg4.js";import"./index-1f7Hqibh.js";const A={class:"default-main ba-table-box"},q=k({name:"collection/assetPackage",__name:"index",setup(C){const{t:o}=B.useI18n(),n=s([]),r=s([]),p=[{type:"selection",align:"center",operator:!1},{label:"ID",prop:"id",align:"center",operator:"=",width:70},{label:"资产包名称",prop:"name",align:"center",operator:"LIKE",operatorPlaceholder:"模糊搜索",minWidth:150},{label:"关联场次",prop:"session_name",align:"center",operator:!1,width:120},{label:"关联分区",prop:"zone_name",align:"center",operator:!1,width:100},{label:"价格范围",prop:"price_range",align:"center",operator:!1,width:150,render:e=>e.min_price||e.max_price?`${e.min_price||0} - ${e.max_price||"∞"}`:"-"},{label:"商品数",prop:"total_count",align:"center",operator:!1,width:80},{label:"已生成",prop:"generated_count",align:"center",operator:!1,width:80},{label:"设定数量",prop:"item_count",align:"center",operator:!1,width:80},{label:"已售",prop:"sold_count",align:"center",operator:!1,width:80},{label:"默认包",prop:"is_default",align:"center",render:"tag",replaceValue:{0:"否",1:"是"},custom:{0:"info",1:"success"},width:80},{label:"状态",prop:"status",align:"center",render:"switch",replaceValue:{0:"禁用",1:"启用"},width:80},{label:o("Create time"),prop:"create_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160},{label:o("Operate"),prop:"operate",align:"center",width:160,render:"buttons",buttons:[],operator:!1}],t=new b(new T("/admin/collection.AssetPackage/"),{column:p},{defaultItems:{status:1,is_default:0,zone_id:0,item_count:0,min_price:350}}),d={name:"setDefault",render:"tipButton",title:"设为默认",text:"",type:"warning",icon:"fa fa-star",class:"table-row-setDefault",disabledTip:!1,display:e=>e.is_default!=1,click:(e,m)=>{t.api.custom({url:"/admin/collection.AssetPackage/setDefault",data:{id:e.id}}).then(()=>{t.onTableAction("refresh",{})})}},u={render:"confirmButton",name:"delete",title:"删除资产包",text:"",type:"danger",icon:"fa fa-trash",class:"table-row-delete",popconfirm:{confirmButtonText:"确认删除",cancelButtonText:"取消",confirmButtonType:"danger",title:`确定要删除选中的资产包吗？

⚠️ 警告：此操作将同时删除该资产包下的所有藏品、用户藏品记录和寄售记录！`},disabledTip:!1},l=[..._(["edit"]),u,d];return l.forEach(e=>{e.display=e.display||(()=>!0)}),t.table.column[t.table.column.length-1].buttons=l,t.auth=()=>!0,t.mount(),y(async()=>{await t.getData();try{const e=await t.api.custom({url:t.api.actionUrl.get("add")});e.data&&(n.value=e.data.sessions||[],r.value=e.data.zones||[])}catch(e){console.error("Failed to load sessions/zones",e)}}),I("baTable",t),(e,m)=>{const f=x("el-alert");return i(),v("div",A,[c(t).table.remark?(i(),D(f,{key:0,class:"ba-table-alert",title:c(t).table.remark,type:"info","show-icon":""},null,8,["title"])):z("",!0),a(g,{buttons:["refresh","add","edit","delete","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":"资产包名称搜索"}),a(w),a(h,{sessions:n.value,zones:r.value},null,8,["sessions","zones"])])}}});export{q as default};
