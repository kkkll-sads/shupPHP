import{b as G}from"./baTable-CpxZN4RR.js";import{_ as O}from"./popupForm.vue_vue_type_script_setup_true_lang-D66Dxsyf.js";import{T as W,a as H}from"./index-B5mnDXNW.js";import{a5 as M,ab as x,c as T,f as $}from"./index-BR6nH71S.js";import{B as q,a as N,a1 as w,I as p,C as K,D as u,O as c,U as f,H as l,u as k,P as a,$ as r,X as s,G as L,at as z}from"./vue-DnSQgQf0.js";import"./validate-B0Iw1M_R.js";import"./index-DGD6GkL-.js";const P={class:"default-main ba-table-box"},le=q({name:"finance/withdrawReview",__name:"index",setup(X){const C={0:"待审核",1:"审核通过",2:"审核拒绝"},V={0:"warning",1:"success",2:"danger"},_=new G(new M("/admin/finance.WithdrawReview/"),{column:[{type:"selection",align:"center",operator:!1},{label:"ID",prop:"id",align:"center",operator:"=",width:70},{label:"申请方",prop:"applicant_name",align:"center",operator:"LIKE"},{label:"申请类型",prop:"applicant_type_text",align:"center",operator:"select",operatorOptions:[{label:"用户",value:"user"},{label:"公司",value:"company"},{label:"合作方",value:"partner"}],replaceValue:{user:"用户",company:"公司",partner:"合作方"},width:100},{label:"申请方ID",prop:"applicant_id",align:"center",operator:"=",width:110},{label:"手机号",prop:"applicant_mobile",align:"center",operator:"LIKE",width:130},{label:"收款方式",prop:"type_text",align:"center",operator:"select",operatorOptions:[{label:"微信",value:"微信"},{label:"支付宝",value:"支付宝"},{label:"银行卡",value:"银行卡"},{label:"USDT",value:"USDT"}],replaceValue:{微信:"微信",支付宝:"支付宝",银行卡:"银行卡",USDT:"USDT"},width:100},{label:"提现金额",prop:"amount",align:"center",operator:"RANGE",width:120,render:(o=>{const e=o.amount;if(e==null||e==="")return"-";const m=parseFloat(e);return isNaN(m)?"-":"¥"+m.toFixed(2)})},{label:"状态",prop:"status",align:"center",operator:"select",operatorOptions:[{label:"待审核",value:"0"},{label:"审核通过",value:"1"},{label:"审核拒绝",value:"2"}],replaceValue:C,render:"tag",custom:V,width:110},{label:"审核时间",prop:"audit_time",align:"center",operator:"RANGE",render:"datetime",width:160},{label:"创建时间",prop:"create_time",align:"center",operator:"RANGE",render:"datetime",width:160},{label:"操作",align:"center",width:220,render:"buttons",buttons:(o=>{const e=[];return e.push({render:"tipButton",name:"read",title:"查看详情",text:"",type:"primary",icon:"fa fa-eye",class:"table-row-read",display:()=>x("read"),click:()=>{R(o)}}),o.status==0&&(e.push({render:"tipButton",name:"approve",title:"审核通过",text:"",type:"success",icon:"fa fa-check",class:"table-row-approve",display:()=>x("approve"),click:()=>{S(o,"approve")}}),e.push({render:"tipButton",name:"reject",title:"审核拒绝",text:"",type:"danger",icon:"fa fa-times",class:"table-row-reject",display:()=>x("reject"),click:()=>{S(o,"reject")}})),e}),operator:!1}],dblClickNotEditColumn:[void 0]}),n=N({visible:!1,loading:!1,type:"approve",title:"",form:{id:0,applicant:"",amount:"",audit_remark:""}}),t=N({visible:!1,data:null}),S=(o,e)=>{n.type=e,n.title=e==="approve"?"审核通过":"审核拒绝";const m=o.amount?parseFloat(o.amount).toFixed(2):"0.00";n.form={id:o.id,applicant:`${o.applicant_name} (${o.applicant_type_text||""})`,amount:m,audit_remark:""},n.visible=!0},U=async()=>{if(n.type==="reject"&&!n.form.audit_remark.trim()){w.warning("拒绝原因不能为空");return}n.loading=!0;try{const o=n.type==="approve"?"/admin/finance.WithdrawReview/approve":"/admin/finance.WithdrawReview/reject",e=await T({url:o,method:"post",data:{id:n.form.id,audit_remark:n.form.audit_remark}});w.success(e.msg||"操作成功"),n.visible=!1,_.getData()}catch(o){!o.msg&&o.message&&w.error(o.message||"操作失败")}finally{n.loading=!1}},R=async o=>{try{const e=await T({url:"/admin/finance.WithdrawReview/read",method:"get",params:{id:o.id}});t.data=e.data.row,t.visible=!0}catch(e){!e.msg&&e.message&&w.error(e.message||"获取详情失败")}},A=o=>V[String(o)]||"info",B=o=>{if(o==null||o==="")return"-";const e=parseFloat(o);return isNaN(e)?"-":"¥"+e.toFixed(2)},E=o=>{if(!o)return"-";const e=new Date(o*1e3),m=e.getFullYear(),b=(e.getMonth()+1).toString().padStart(2,"0"),y=e.getDate().toString().padStart(2,"0"),h=e.getHours().toString().padStart(2,"0"),g=e.getMinutes().toString().padStart(2,"0"),v=e.getSeconds().toString().padStart(2,"0");return`${m}-${b}-${y} ${h}:${g}:${v}`};return _.mount(),_.getData(),z("baTable",_),(o,e)=>{const m=p("el-alert"),b=p("el-input"),y=p("el-form-item"),h=p("el-form"),g=p("el-button"),v=p("el-dialog"),i=p("el-descriptions-item"),F=p("el-tag"),D=p("el-descriptions"),j=p("el-divider"),I=p("el-image");return u(),K("div",P,[k(_).table.remark?(u(),c(m,{key:0,class:"ba-table-alert",title:k(_).table.remark,type:"info","show-icon":""},null,8,["title"])):f("",!0),l(W,{buttons:["refresh","export","add","edit","delete","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":"快速搜索：申请方名称/类型"}),l(H),l(O),l(v,{modelValue:n.visible,"onUpdate:modelValue":e[4]||(e[4]=d=>n.visible=d),title:n.title,width:"520px","close-on-click-modal":!1},{footer:a(()=>[l(g,{onClick:e[3]||(e[3]=d=>n.visible=!1)},{default:a(()=>e[8]||(e[8]=[r("取消")])),_:1}),l(g,{type:"primary",onClick:U,loading:n.loading},{default:a(()=>[r(s(n.type==="approve"?"通过":"拒绝"),1)]),_:1},8,["loading"])]),default:a(()=>[l(h,{model:n.form,"label-width":"120px"},{default:a(()=>[l(y,{label:"申请方"},{default:a(()=>[l(b,{modelValue:n.form.applicant,"onUpdate:modelValue":e[0]||(e[0]=d=>n.form.applicant=d),disabled:""},null,8,["modelValue"])]),_:1}),l(y,{label:"提现金额"},{default:a(()=>[l(b,{modelValue:n.form.amount,"onUpdate:modelValue":e[1]||(e[1]=d=>n.form.amount=d),disabled:""},{append:a(()=>e[7]||(e[7]=[r("元")])),_:1},8,["modelValue"])]),_:1}),l(y,{label:"审核备注"},{default:a(()=>[l(b,{modelValue:n.form.audit_remark,"onUpdate:modelValue":e[2]||(e[2]=d=>n.form.audit_remark=d),type:"textarea",rows:4,placeholder:n.type==="approve"?"可以填写审核备注（选填）":"请输入拒绝原因"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(v,{modelValue:t.visible,"onUpdate:modelValue":e[6]||(e[6]=d=>t.visible=d),title:"提现审核详情",width:"720px","close-on-click-modal":!1},{footer:a(()=>[l(g,{onClick:e[5]||(e[5]=d=>t.visible=!1)},{default:a(()=>e[10]||(e[10]=[r("关闭")])),_:1})]),default:a(()=>[t.data?(u(),c(D,{key:0,column:2,border:""},{default:a(()=>[l(i,{label:"申请方"},{default:a(()=>[r(s(t.data.applicant_name),1)]),_:1}),l(i,{label:"申请类型"},{default:a(()=>[r(s(t.data.applicant_type_text),1)]),_:1}),l(i,{label:"申请方ID"},{default:a(()=>[r(s(t.data.applicant_id||"-"),1)]),_:1}),l(i,{label:"手机号"},{default:a(()=>[r(s(t.data.applicant_mobile||"-"),1)]),_:1}),l(i,{label:"收款方式"},{default:a(()=>[r(s(t.data.type_text||"-"),1)]),_:1}),l(i,{label:"提现金额"},{default:a(()=>[r(s(B(t.data.amount)),1)]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(F,{type:A(t.data.status)},{default:a(()=>[r(s(t.data.status_text),1)]),_:1},8,["type"])]),_:1}),l(i,{label:"申请时间"},{default:a(()=>[r(s(E(t.data.create_time)),1)]),_:1}),l(i,{label:"审核时间"},{default:a(()=>[r(s(t.data.audit_time_text||"-"),1)]),_:1}),l(i,{label:"审核人"},{default:a(()=>[r(s(t.data.audit_admin_name||"-"),1)]),_:1}),l(i,{label:"申请说明",span:2},{default:a(()=>[r(s(t.data.apply_reason||"-"),1)]),_:1}),l(i,{label:"审核备注",span:2},{default:a(()=>[r(s(t.data.audit_remark||"-"),1)]),_:1})]),_:1})):f("",!0),t.data&&t.data.payment_info?(u(),c(j,{key:1,"content-position":"left"},{default:a(()=>e[9]||(e[9]=[L("span",{style:{"font-size":"16px","font-weight":"bold"}},"收款信息",-1)])),_:1})):f("",!0),t.data&&t.data.payment_info?(u(),c(D,{key:2,column:2,border:""},{default:a(()=>[l(i,{label:"收款方式"},{default:a(()=>[r(s(t.data.payment_info.type_text),1)]),_:1}),l(i,{label:"账户类型"},{default:a(()=>[r(s(t.data.payment_info.account_type_text),1)]),_:1}),l(i,{label:"账户姓名"},{default:a(()=>[r(s(t.data.payment_info.account_name||"-"),1)]),_:1}),t.data.payment_info.account_number?(u(),c(i,{key:0,label:"账号/卡号"},{default:a(()=>[r(s(t.data.payment_info.account_number),1)]),_:1})):f("",!0),t.data.payment_info.bank_name?(u(),c(i,{key:1,label:"开户银行"},{default:a(()=>[r(s(t.data.payment_info.bank_name),1)]),_:1})):f("",!0),t.data.payment_info.bank_branch?(u(),c(i,{key:2,label:"开户支行"},{default:a(()=>[r(s(t.data.payment_info.bank_branch),1)]),_:1})):f("",!0),t.data.payment_info.type==="wechat"&&t.data.payment_info.screenshot?(u(),c(i,{key:3,label:"微信收款码",span:2},{default:a(()=>[l(I,{src:k($)(t.data.payment_info.screenshot),style:{width:"200px",height:"auto","max-height":"300px",cursor:"pointer"},"preview-src-list":[k($)(t.data.payment_info.screenshot)],fit:"contain","preview-teleported":""},null,8,["src","preview-src-list"])]),_:1})):f("",!0)]),_:1})):f("",!0)]),_:1},8,["modelValue"])])}}});export{le as default};
