import{b as w}from"./baTable-Cho2KrQQ.js";import T from"./popupForm-DywfRJkq.js";import{T as k,a as B}from"./index-Cl6ixW7i.js";import{v as E,a5 as N,_ as I}from"./index-DNBbsmjl.js";import{B as D,b as F,I as u,C,D as _,O as f,U as g,H as o,u as c,P as n,G as l,X as m,ai as h,a1 as b,at as O}from"./vue-_nkvHh4F.js";import"./index-BNmCRBQg.js";const P={class:"default-main ba-table-box"},q={class:"stat-item"},A={class:"stat-value"},z={class:"stat-item"},G={class:"stat-value primary"},H={class:"stat-item"},V={class:"stat-value success"},K={class:"stat-item"},L={class:"stat-value info"},S=D({name:"finance/order",__name:"index",setup(M){const{t:r}=E.useI18n(),s=F(null),v=[{render:"tipButton",name:"info",title:"查看详情",text:"详情",type:"primary",icon:"fa fa-eye",class:"table-row-detail",disabledTip:!1,display:()=>!0,click:e=>{t.toggleForm("Edit",[e.id])}},{render:"tipButton",name:"settle",title:"手动结算",text:"结算",type:"success",icon:"fa fa-check-circle",class:"table-row-settle",disabledTip:!1,display:e=>e.status==="earning",click:e=>{h.confirm("确认要手动结算此订单吗？将立即返还本金和收益给用户。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.api.postData("settle",{id:e.id}).then(a=>{b.success(a.msg||"结算成功"),t.onTableHeaderAction("refresh",{})}).catch(a=>{b.error(a.msg||"结算失败")})}).catch(()=>{})}},{render:"tipButton",name:"cancel",title:"取消订单",text:"取消",type:"danger",icon:"fa fa-times",class:"table-row-cancel",disabledTip:!1,display:e=>["pending","paying","earning"].includes(e.status),click:e=>{const a=e.status==="earning"?"取消订单将退还本金给用户，确认继续吗？":"确认要取消此订单吗？";h.confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.api.postData("cancel",{id:e.id}).then(i=>{b.success(i.msg||"取消成功"),t.onTableHeaderAction("refresh",{})}).catch(i=>{b.error(i.msg||"取消失败")})}).catch(()=>{})}}],t=new w(new N("/admin/finance.Order/"),{column:[{type:"selection",align:"center",operator:!1},{label:r("Id"),prop:"id",align:"center",operator:"=",operatorPlaceholder:r("Id"),width:70},{label:"订单号",prop:"order_no",align:"center",operator:"LIKE",operatorPlaceholder:r("Fuzzy query")},{label:"用户",prop:"user_nickname",align:"center",operator:"LIKE",operatorPlaceholder:"用户昵称",render:e=>e.user_nickname||"--"},{label:"产品名称",prop:"product_name",align:"center",operator:"LIKE",operatorPlaceholder:r("Fuzzy query")},{label:"购买金额",prop:"amount",align:"center",operator:"BETWEEN",render:e=>{const a=Number(e.amount);return isNaN(a)?e.amount:"¥"+a.toFixed(2)}},{label:"收益率",prop:"yield_rate",align:"center",operator:"BETWEEN",width:90,render:e=>`${e.yield_rate}%`},{label:"预期收益",prop:"expected_income",align:"center",operator:!1,render:e=>"¥"+Number(e.expected_income||0).toFixed(2)},{label:"支付方式",prop:"payment_channel",align:"center",operator:"select",operatorOptions:[{label:"余额支付",value:"balance"},{label:"支付宝",value:"alipay"},{label:"微信支付",value:"wechat"},{label:"银联支付",value:"union"}],width:100,render:e=>e.payment_channel_text||"--"},{label:"订单状态",prop:"status",align:"center",render:"tag",operator:"select",operatorOptions:[{label:"待支付",value:"pending"},{label:"支付中",value:"paying"},{label:"支付成功",value:"paid"},{label:"收益中",value:"earning"},{label:"已完成",value:"completed"},{label:"已取消",value:"cancelled"},{label:"已退款",value:"refunded"}],width:100,custom:{pending:"info",paying:"warning",paid:"primary",earning:"success",completed:"",cancelled:"danger",refunded:"warning"},replaceValue:{pending:"待支付",paying:"支付中",paid:"支付成功",earning:"收益中",completed:"已完成",cancelled:"已取消",refunded:"已退款"}},{label:"到期时间",prop:"expire_time_text",align:"center",operator:!1,width:160},{label:"支付时间",prop:"pay_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160,show:!1},{label:r("Create time"),prop:"create_time",align:"center",render:"datetime",sortable:"custom",operator:"RANGE",width:160},{label:r("Operate"),align:"center",width:200,render:"buttons",buttons:v,operator:!1}]},{defaultItems:{}}),y=t.getData.bind(t);return t.getData=async()=>{await y(),t.table.extend&&t.table.extend.statistics&&(s.value=t.table.extend.statistics)},t.onTableDone=e=>{e&&e.data&&e.data.statistics&&(s.value=e.data.statistics)},t.mount(),t.getData(),O("baTable",t),(e,a)=>{const i=u("el-alert"),d=u("el-card"),p=u("el-col"),x=u("el-row");return _(),C("div",P,[c(t).table.remark?(_(),f(i,{key:0,class:"ba-table-alert",title:c(t).table.remark,type:"info","show-icon":""},null,8,["title"])):g("",!0),s.value?(_(),f(x,{key:1,gutter:20,class:"statistics-row"},{default:n(()=>[o(p,{span:6},{default:n(()=>[o(d,{shadow:"hover"},{default:n(()=>[l("div",q,[a[0]||(a[0]=l("div",{class:"stat-label"},"订单总数",-1)),l("div",A,m(s.value.total_summary.total_orders||0),1)])]),_:1})]),_:1}),o(p,{span:6},{default:n(()=>[o(d,{shadow:"hover"},{default:n(()=>[l("div",z,[a[1]||(a[1]=l("div",{class:"stat-label"},"订单总额",-1)),l("div",G,"¥"+m((s.value.total_summary.total_amount||0).toFixed(2)),1)])]),_:1})]),_:1}),o(p,{span:6},{default:n(()=>[o(d,{shadow:"hover"},{default:n(()=>[l("div",H,[a[2]||(a[2]=l("div",{class:"stat-label"},"收益中金额",-1)),l("div",V,"¥"+m((s.value.total_summary.earning_amount||0).toFixed(2)),1)])]),_:1})]),_:1}),o(p,{span:6},{default:n(()=>[o(d,{shadow:"hover"},{default:n(()=>[l("div",K,[a[3]||(a[3]=l("div",{class:"stat-label"},"已完成金额",-1)),l("div",L,"¥"+m((s.value.total_summary.completed_amount||0).toFixed(2)),1)])]),_:1})]),_:1})]),_:1})):g("",!0),o(k,{buttons:["refresh","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":c(r)("Quick search placeholder",{fields:c(r)("finance.order.Order No")+"/"+c(r)("Id")})},null,8,["quick-search-placeholder"]),o(B),o(T)])}}}),X=I(S,[["__scopeId","data-v-9a6a68b4"]]);export{X as default};
