# æ’®åˆè„šæœ¬ä½¿ç”¨è¯´æ˜

## é—®é¢˜åŸå› 

é”™è¯¯ `Could not open input file: think` æ˜¯å› ä¸ºé¡¹ç›®ä¸­æ²¡æœ‰ `think` å‘½ä»¤è¡Œå·¥å…·æ–‡ä»¶ã€‚

è¿™ä¸ªé¡¹ç›®ä½¿ç”¨çš„æ˜¯ **ThinkPHP 6+**ï¼Œå‘½ä»¤è¡Œå·¥å…·éœ€è¦é€šè¿‡ PHP ç›´æ¥è°ƒç”¨ã€‚

## æ­£ç¡®çš„æ‰§è¡Œæ–¹å¼

### æ–¹å¼1ï¼šä½¿ç”¨åŒ…è£…è„šæœ¬ï¼ˆæ¨èï¼‰

æˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ–¹ä¾¿çš„åŒ…è£…è„šæœ¬ `run_matching.sh`ï¼š

```bash
cd /www/wwwroot/23.248.226.82
bash run_matching.sh
```

**å¼ºåˆ¶æ’®åˆæ¨¡å¼**ï¼ˆå¿½ç•¥åœºæ¬¡æ—¶é—´é™åˆ¶ï¼‰ï¼š
```bash
bash run_matching.sh --force
```

### æ–¹å¼2ï¼šç›´æ¥ä½¿ç”¨ PHP å‘½ä»¤

```bash
cd /www/wwwroot/23.248.226.82
php -r "require 'vendor/autoload.php'; \$app = new think\App(); \$app->console->run();" collection:matching
```

**å¼ºåˆ¶æ’®åˆæ¨¡å¼**ï¼š
```bash
php -r "require 'vendor/autoload.php'; \$app = new think\App(); \$app->console->run();" collection:matching --force
```

## æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤

```bash
cd /www/wwwroot/23.248.226.82
php -r "require 'vendor/autoload.php'; \$app = new think\App(); \$app->console->run();" list
```

### è—å“ç›¸å…³å‘½ä»¤

```
collection:daily:dividend   æ¯æ—¥åˆ†çº¢ç»“ç®—ï¼ˆæŒ‰å½“æ—¥å·²å”®å‡ºè®¢å•åˆ©æ¶¦åˆ†é…ï¼‰å¹¶å¤„ç†æ¬¡æ—¥è‡ªåŠ¨ä¸Šæ¶
collection:matching         è—å“æ’®åˆæ± è‡ªåŠ¨æ’®åˆï¼ˆè½®ç›˜èµŒæœºåˆ¶ï¼‰
collection:mining:check     è—å“å¼ºåˆ¶é”ä»“è½¬ä¸ºçŸ¿æœºæ£€æŸ¥
collection:mining:dividend  çŸ¿æœºæ¯æ—¥åˆ†çº¢å‘æ”¾
```

## å®šæ—¶ä»»åŠ¡é…ç½®

### æ·»åŠ åˆ° Crontab

```bash
crontab -e
```

æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼‰ï¼š

```cron
* * * * * cd /www/wwwroot/23.248.226.82 && bash run_matching.sh >> /tmp/collection_matching.log 2>&1
```

æˆ–æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼š

```cron
*/5 * * * * cd /www/wwwroot/23.248.226.82 && bash run_matching.sh >> /tmp/collection_matching.log 2>&1
```

### æŸ¥çœ‹æ—¥å¿—

```bash
tail -f /tmp/collection_matching.log
```

## æ’®åˆè„šæœ¬åŠŸèƒ½

### 1. åœºæ¬¡ç»“æŸè‡ªåŠ¨ä¸‹æ¶å¯„å”®è®¢å•
- æ£€æµ‹æ‰€æœ‰å·²ç»“æŸçš„åœºæ¬¡
- è‡ªåŠ¨ä¸‹æ¶è¯¥åœºæ¬¡ä¸‹æ‰€æœ‰å¯„å”®ä¸­çš„è®¢å•
- å¢åŠ å…è´¹å¯„å”®æ¬¡æ•°ï¼ˆè¡¥å¿æœºåˆ¶ï¼‰
- è®°å½•æ´»åŠ¨æ—¥å¿—

### 2. æ’®åˆæ± æ’®åˆï¼ˆè½®ç›˜èµŒæœºåˆ¶ï¼‰
- å¤„ç†ç”¨æˆ·ç«ä»·è´­ä¹°è®°å½•
- ä½¿ç”¨è½®ç›˜èµŒç®—æ³•æ ¹æ®æƒé‡åˆ†é…ä¸­ç­¾åé¢
- å‘æ”¾è—å“å’Œåˆ†é…æ”¶ç›Š

### 3. ç›²ç›’é¢„çº¦æ’®åˆ
- å¤„ç†ç”¨æˆ·çš„ç›²ç›’é¢„çº¦è®¢å•
- åŒ¹é…å¯ç”¨çš„å¯„å”®å•†å“
- ä¼˜å…ˆçº§ï¼šæ—§èµ„äº§åŒ… > è€ç”¨æˆ· > ç³»ç»Ÿå• > æ—©å¯„å”®

## æ‰§è¡Œç¤ºä¾‹

åˆšæ‰çš„æ‰§è¡Œç»“æœæ˜¾ç¤ºï¼š

```
================================================================================
[2026-01-14 21:12:28] ğŸ¤– å¼€å§‹å¤„ç†æ’®åˆæ± æ’®åˆï¼ˆè½®ç›˜èµŒæœºåˆ¶ï¼‰- è‡ªåŠ¨è¿è¡Œ
================================================================================

--------------------------------------------------------------------------------
ã€æ’®åˆæ± æ’®åˆç»“æœã€‘
  å¤„ç†: 0 | ä¸­ç­¾: 0 | æœªä¸­ç­¾: 0 | å¤±è´¥: 0 | è€—æ—¶: 0.02ç§’
--------------------------------------------------------------------------------

[2026-01-14 21:12:28] å¼€å§‹å¤„ç†ç›²ç›’é¢„çº¦æ’®åˆ...
  å¼€å§‹å¤„ç†ä¸“åœºã€æ•°å­—æµé‡æ± ã€‘çš„ç›²ç›’é¢„çº¦æ’®åˆ...
  ğŸ‘¥ ç›²ç›’é¢„çº¦äººæ•°ï¼š329
  ğŸ“¦ åˆ†åŒºåº“å­˜ã€1300å…ƒåŒºã€‘ï¼šå•†å“æ•° 5311ï¼Œåº“å­˜ 4669
  âœ“ ç”¨æˆ·ID 956 ç›²ç›’ä¸­ç­¾ï¼Œå•†å“ID 13333ï¼Œä»·æ ¼ 1204.62ï¼Œé€€å·® 95.38
  ...
```

è¯´æ˜æ’®åˆè„šæœ¬æ­£å¸¸è¿è¡Œï¼Œæ­£åœ¨å¤„ç†ç›²ç›’é¢„çº¦æ’®åˆã€‚

## æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šæƒé™é”™è¯¯

```bash
chmod +x /www/wwwroot/23.248.226.82/run_matching.sh
chmod 777 /tmp
```

### é—®é¢˜2ï¼šPHP ç‰ˆæœ¬é—®é¢˜

ç¡®ä¿ PHP ç‰ˆæœ¬ >= 7.4ï¼š

```bash
php -v
```

å½“å‰ç‰ˆæœ¬ï¼šPHP 8.2.28 âœ…

### é—®é¢˜3ï¼šä¾èµ–åŒ…ç¼ºå¤±

```bash
cd /www/wwwroot/23.248.226.82
composer install
```

## å…¶ä»–å‘½ä»¤ç¤ºä¾‹

### çŸ¿æœºæ¯æ—¥åˆ†çº¢

```bash
bash run_matching.sh collection:mining:dividend
```

æˆ–ï¼š

```bash
php -r "require 'vendor/autoload.php'; \$app = new think\App(); \$app->console->run();" collection:mining:dividend
```

### æ¯æ—¥åˆ†çº¢ç»“ç®—

```bash
php -r "require 'vendor/autoload.php'; \$app = new think\App(); \$app->console->run();" collection:daily:dividend
```

## æ€»ç»“

âœ… **æ­£ç¡®å‘½ä»¤**ï¼š`bash run_matching.sh` æˆ–ä½¿ç”¨å®Œæ•´çš„ PHP å‘½ä»¤

âŒ **é”™è¯¯å‘½ä»¤**ï¼š`php think collection:matching`ï¼ˆå› ä¸ºæ²¡æœ‰ think æ–‡ä»¶ï¼‰

---

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-14
**æœ€åæ›´æ–°**ï¼š2026-01-14
