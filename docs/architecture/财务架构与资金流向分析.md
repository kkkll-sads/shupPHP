# 财务架构与资金流向分析（业务员讲解版）
（Financial Architecture & Money Flow — Sales-Friendly Guide）

本文件给**业务员/客服**使用：用最直白的话，讲清楚"钱从哪来、到哪去、能提现吗、为什么要分口袋"。

> 版本：统一口径版 v5  
> 更新日期：2025-12-27  
> 关键更新：
> - **未中签/取消退款统一退回"可用余额（专项金）"**
> - **代理佣金系统：累计制+同级特殊处理（全额进可提现余额）**

---

## 一句话先讲明白（给客户的版本）

平台把资金分成 **4 个口袋** + 2 个功能字段：

- **可用余额（专项金）**：客户**充值进来的钱**，以及**退款回来的钱**，优先用来买/预约。
- **可提现余额**：成交回款、分红、佣金等进入，**能提现，也能买**（当可用余额不足时补扣）。
- **积分/消费金**：利润和分红会有一部分进入，**不能提现**，用于商城抵扣/兑换绿色算力。
- **确权金（手续费余额）**：专门用于寄售上架扣手续费，**只能转入、不可逆**。

> `money（总资产）` 只是**展示数字**：等于上面四个口袋加起来，不是一个能直接操作的“钱包”。

---

## 0. money（总资产）到底是什么？

```js
// money 仅展示：四字段求和
money = balance_available + withdrawable_money + score + service_fee_balance
```

### 业务员怎么解释
- **money = 总资产展示**（类似“资产总览”），不是一个单独可花、可提现的账户。
- 真正可操作的是四个口袋：可用、可提现、积分、确权金。

---

## 1. 四个口袋分别能做什么（最重要）

| 口袋 | 对应字段 | 从哪来 | 能做什么 | 不能做什么 |
|---|---|---|---|---|
| 可用余额（专项金） | `balance_available` | **充值** + **退款统一回到这里** | 买藏品/预约（优先扣），可划转到确权金 | 不能提现 |
| 可提现余额 | `withdrawable_money` | 成交本金/利润分配、分红分配、分润佣金等 | **提现**、买藏品（可用余额不足时补扣） | —— |
| 积分/消费金 | `score` | 利润 50%、分红 50%、活动赠送等 | 商城抵扣、兑换绿色算力 | 不能提现 |
| 确权金（手续费余额） | `service_fee_balance` | 从可用/可提现划转或充值（如开放） | 用于寄售上架手续费扣除 | **不可逆划转回去** |

### 绿色算力（不是钱，是“燃料”）
- 字段：`green_power`
- 来源：**首次注册赠送** + **积分兑换**
- 用途：预约/撮合需要消耗（按业务规则）

---

## 2. 充值、购买、退款、成交、分红、分润：每一步钱怎么走

---

### 2.1 充值（Recharge）

**规则**：充值只进 **可用余额（专项金）**。

```js
balance_available += recharge_amount
```

**业务员话术**：
- “您充值的钱会先进入**可用余额**，优先用于买/预约。”

---

### 2.2 购买/预约（混合支付）

**规则**：购买/预约支持 **可用余额 + 可提现余额** 混合支付，**优先扣可用余额**。

```js
need = Price
pay_from_balance = min(balance_available, need)
pay_from_withdrawable = need - pay_from_balance

balance_available  -= pay_from_balance
withdrawable_money -= pay_from_withdrawable
```

**业务员话术**：
- “系统会先用您充值的可用余额，不够的部分再自动用可提现余额补上。”

---

### 2.3 未中签/取消退款（统一退回专项金）

**规则（最新）**：如果预约未中签、被取消、超时释放名额等触发退款，  
**退款金额统一退回 `balance_available（可用余额/专项金）`**。

```js
balance_available += refund_amount
```

**业务员话术（必须讲清）**：
- “这类退款会**统一退回可用余额**，方便您继续参与下一轮购买/预约。”
- “可用余额不能提现，但可以用于购买/预约，也可以划转到确权金（若您需要寄售）。”

> ✅ 提示：这条规则要写进【规则说明/用户协议/订单页面提示】，避免客户误解产生争议。

---

### 2.4 寄售成交（业务员必须讲清）

#### 所有藏品的“利润切分规则”（你确认：所有藏品利润都切）
**规则（统一口径）**：
- **本金（Price）**：100% 到 **可提现余额**
- **利润（Profit）**：50% 到 **可提现余额**，50% 到 **积分/消费金**

```js
withdrawable_money += Price
withdrawable_money += Profit * 0.50
score             += Profit * 0.50
```

**业务员话术**：
- “成交后，本金**全额**进可提现；利润一半进可提现、一半到消费金，消费金可以购物抵扣或换算力。”

---

### 2.5 分红收益（Dividends / Bonus）

**规则**：分红收益 50% 到可提现、50% 到积分。

```js
withdrawable_money += income * 0.50
score             += income * 0.50
```

**业务员话术**：
- “分红会一半进可提现，一半进消费金。”

---

### 2.6 分润/佣金（Commission）

**规则**：分润/佣金 **全额到账** 到可提现余额（100%）。

```js
withdrawable_money += commission
```

#### 代理佣金体系（三种类型）

当卖家寄售成交时，系统会根据代理关系链自动分配佣金：

**1. 直推佣金（默认10%）**
- 发放对象：卖家的直接邀请人
- 佣金计算：卖家利润 × 10%
- 示例：卖家赚了100元利润，直推拿10元

**2. 间推佣金（默认5%）**
- 发放对象：直推的邀请人（二级邀请人）
- 佣金计算：卖家利润 × 5%
- 示例：卖家赚了100元利润，间推拿5元

**3. 代理团队奖（累计制+同级特殊处理）**

**正常情况（累计级差制）：**
- 1级代理：利润 × 9%
- 2级代理：利润 × 3%（12% - 9%）
- 3级代理：利润 × 3%（15% - 12%）
- 4级代理：利润 × 3%（18% - 15%）
- 5级代理：利润 × 3%（21% - 18%）

**同级特殊处理：**
- 如果上级代理和下级代理是**同一等级**（例如都是1级代理）
- 上级代理只拿 **10%的同级奖**（不按级差计算）

**示例1（正常级差）：**
```
邀请链：卖家 → A(1级代理) → B(3级代理) → C(5级代理)
卖家利润：100元
- A(1级代理)：100 × 9% = 9元
- B(3级代理)：100 × (15%-9%) = 6元
- C(5级代理)：100 × (21%-15%) = 6元
```

**示例2（同级特殊处理）：**
```
邀请链：卖家 → A(1级代理) → B(1级代理) → C(3级代理)
卖家利润：100元
- A(1级代理)：100 × 9% = 9元（层级奖）
- B(1级代理)：100 × 10% = 10元（同级奖，因为和A同级）
- C(3级代理)：100 × (15%-9%) = 6元（层级奖）
```

**业务员话术**：
- "佣金是全额进可提现，到账就是可提现的那部分。"
- "代理佣金有三种：直推拿10%、间推拿5%、团队奖按级差分配。"
- "特殊情况：如果上级和下级是同一等级的代理，上级拿固定10%的同级奖。"
- "所有佣金都是从卖家的利润中抽取，不影响卖家本金和利润分配。"

---

### 2.7 划转确权金（手续费余额）——不可逆（一定要讲清）

**规则**：只能从 **可用余额** 或 **可提现余额** 划转到 **确权金**，且不可逆。

```js
// 从可用余额划转
balance_available   -= x
service_fee_balance += x

// 或从可提现余额划转
withdrawable_money  -= y
service_fee_balance += y

// 禁止反向划转
// service_fee_balance -> (balance_available/withdrawable_money)  ❌
```

**业务员话术**：
- “确权金是寄售手续费专用余额，**只能转进去、不能转出来**，转之前确认金额。”

---

### 2.8 绿色算力来源与兑换

- **首次注册赠送**：系统直接给算力
- **积分兑换**：用积分换算力

```js
green_power += register_bonus

score       -= cost_score
green_power += gain_green_power
```

**业务员话术**：
- “算力不是现金，是用于预约/撮合的燃料。注册会送一部分，后续也能用消费金兑换。”

---

## 3. 业务员必会的 5 个例子（带数字，最快让人听懂）

### 例 1：充值
- 充值 1000  
→ 可用余额 +1000

### 例 2：混合支付买/预约
- 可用余额 200，可提现余额 100，要买 250  
→ 扣可用 200 + 扣可提现 50  
→ 买完：可用 0，可提现 50

### 例 3：未中签退款（统一退回可用余额）
承接例 2：这笔预约未中签，退款 250  
→ **可用余额 +250**（统一退回专项金）  
→ 变成：可用 250，可提现 50

### 例 4：寄售成交（本金全额可提现 + 利润 50/50）
- 成交价 Price=100，利润 Profit=10  
→ 可提现 +100（本金）+5（利润一半）= +105  
→ 积分 +5（利润一半）

### 例 5：代理佣金分配
- 卖家A成交，利润100元，邀请链：A → B(1级代理) → C(1级代理) → D(3级代理)
→ A本人：本金+利润按规则分配（例4）
→ B(直推)：10元佣金到可提现
→ A的间推（上上级）：5元佣金到可提现
→ B(1级代理团队奖)：9元到可提现
→ C(1级代理同级奖)：10元到可提现（因为和B同级）
→ D(3级代理团队奖)：6元到可提现（15%-9%）

### 例 6：旧资产解锁（多次）
- 消耗待激活金 1000  
→ 获得**藏品**（价值1000）+ 1张寄售券
（注意：不进余额，需寄售卖出后才有资金）

---

## 4. 客户最常问（FAQ 给业务员直接照读）

**Q1：为什么要分可用余额和可提现余额？**  
A：充值和退款进可用余额，用途更清晰；成交回款、收益进可提现余额，方便提现和复投。

**Q2：消费金（积分）能提现吗？**  
A：不能提现，用于商城抵扣、兑换绿色算力等。

**Q3：我混合支付了，没中签退款会退到哪里？**  
A：**统一退回可用余额（专项金）**，方便继续参与下一轮购买/预约。

**Q4：寄售成交后，我到底拿到多少？**  
A：本金是**100% 可提现**；利润一半可提现、一半到消费金（所有藏品都按这个利润切分）。

**Q5：代理佣金怎么算？**  
A：卖家成交时，系统会从卖家的利润中抽取佣金发给上级代理：
- 直推（直接邀请人）拿10%
- 间推（直推的邀请人）拿5%
- 代理团队奖按等级累计分配（1-5级，累计9%-21%）
- 特殊：如果上级和下级是同一等级，上级只拿10%的同级奖
- 所有佣金全额进可提现余额

**Q6：确权金转进去还能转回来吗？**  
A：不能。确权金是手续费专用余额，划转是不可逆的。

---

## 5. 给研发/运营的提示（业务员可不看）

```js
// 1) 退款规则已调整：未中签/取消退款 -> 统一加回 balance_available
// 2) 退款必须幂等：同一订单同一退款类型只能退一次（idempotent_key）
// 3) 仍建议保留 pay_from_balance/pay_from_withdrawable（用于审计与对账），但退款不再按来源拆分
// 4) 50/50 分配取整规则必须明确（差额建议补到 withdrawable_money）
// 5) 所有扣款前校验余额，避免负数；所有入账落 wallet_flow 便于对账
```
